---
// 高度な分析コンポーネント
---

<div class="advanced-analytics-section">
  <!-- コンテンツ複雑度分析 -->
  <div class="analysis-card" id="complexity-card">
    <h2 class="card-title">コンテンツ複雑度分析</h2>
    <div class="complexity-chart-container">
      <div id="complexity-chart"></div>
      <div class="complexity-legend">
        <div class="legend-item">
          <span class="legend-color" style="background-color: #93c5fd"></span>
          <span class="legend-text">読みやすさスコア</span>
        </div>
        <div class="legend-item">
          <span class="legend-color" style="background-color: #f472b6"></span>
          <span class="legend-text">文章の複雑さ</span>
        </div>
        <div class="legend-item">
          <span class="legend-color" style="background-color: #fbbf24"></span>
          <span class="legend-text">専門用語の割合</span>
        </div>
      </div>
    </div>
  </div>
  
  <!-- アクティビティピーク分析 -->
  <div class="analysis-card" id="activity-peaks-card">
    <h2 class="card-title">アクティビティピーク分析</h2>
    <div class="peaks-chart-container">
      <div id="peaks-chart"></div>
      <div class="peaks-insights">
        <h3>主要なピーク期間</h3>
        <ul class="peaks-list">
          <li>
            <div class="peak-date">2024年2月15日 - 2024年2月28日</div>
            <div class="peak-description">最も活発な期間（28件の更新）</div>
          </li>
          <li>
            <div class="peak-date">2023年12月1日 - 2023年12月15日</div>
            <div class="peak-description">大規模コンテンツ追加（17件の新規作成）</div>
          </li>
        </ul>
      </div>
    </div>
  </div>
  
  <!-- コンテンツ進化分析 -->
  <div class="analysis-card" id="content-evolution-card">
    <h2 class="card-title">コンテンツ進化分析</h2>
    <div class="evolution-chart-container">
      <div id="evolution-chart"></div>
      <div class="evolution-stats">
        <div class="stat-item">
          <div class="stat-value">42%</div>
          <div class="stat-label">成長率（過去3ヶ月）</div>
        </div>
        <div class="stat-item">
          <div class="stat-value">8.3</div>
          <div class="stat-label">平均改訂回数</div>
        </div>
        <div class="stat-item">
          <div class="stat-value">6.2</div>
          <div class="stat-label">平均改善スコア</div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- ナレッジクラスター分析 -->
  <div class="analysis-card" id="knowledge-clusters-card">
    <h2 class="card-title">ナレッジクラスター分析</h2>
    <div class="clusters-container">
      <div id="clusters-chart"></div>
      <div class="clusters-info">
        <h3>主要クラスター</h3>
        <div class="cluster-items">
          <div class="cluster-item">
            <div class="cluster-name">API設計（8項目）</div>
            <div class="cluster-tags">
              <span class="cluster-tag">REST</span>
              <span class="cluster-tag">GraphQL</span>
              <span class="cluster-tag">認証</span>
            </div>
          </div>
          <div class="cluster-item">
            <div class="cluster-name">バックエンド（12項目）</div>
            <div class="cluster-tags">
              <span class="cluster-tag">Node.js</span>
              <span class="cluster-tag">データベース</span>
              <span class="cluster-tag">パフォーマンス</span>
            </div>
          </div>
          <div class="cluster-item">
            <div class="cluster-name">ユーザー体験（7項目）</div>
            <div class="cluster-tags">
              <span class="cluster-tag">UI</span>
              <span class="cluster-tag">アクセシビリティ</span>
              <span class="cluster-tag">モバイル</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- 参照ネットワーク分析 -->
  <div class="analysis-card" id="reference-network-card">
    <h2 class="card-title">参照ネットワーク分析</h2>
    <div class="network-metrics">
      <div class="metric-item">
        <div class="metric-value">3.4</div>
        <div class="metric-label">平均分離度</div>
      </div>
      <div class="metric-item">
        <div class="metric-value">0.68</div>
        <div class="metric-label">クラスタリング係数</div>
      </div>
      <div class="metric-item">
        <div class="metric-value">24%</div>
        <div class="metric-label">孤立ノード率</div>
      </div>
      <div class="metric-item">
        <div class="metric-value">5</div>
        <div class="metric-label">最大接続数</div>
      </div>
    </div>
    <div id="reference-network-chart"></div>
    <div class="network-insights">
      <h3>ネットワーク分析洞察</h3>
      <p>リンク密度が高い領域が2つあり、ドキュメントとチュートリアルの間に強い相互参照が見られます。ウィキカテゴリにはより多くの双方向リンクを追加することで結合度を高める余地があります。</p>
    </div>
  </div>
  
  <!-- ページ寿命・更新サイクル分析 -->
  <div class="analysis-card" id="lifecycle-card">
    <h2 class="card-title">ページ寿命・更新サイクル分析</h2>
    <div class="lifecycle-container">
      <div id="lifecycle-chart"></div>
      <div class="lifecycle-stats">
        <div class="stat-grid">
          <div class="stat-item">
            <div class="stat-value">28.3</div>
            <div class="stat-label">平均更新間隔（日）</div>
          </div>
          <div class="stat-item">
            <div class="stat-value">87%</div>
            <div class="stat-label">メンテナンス率</div>
          </div>
          <div class="stat-item">
            <div class="stat-value">345</div>
            <div class="stat-label">最長寿命（日）</div>
          </div>
          <div class="stat-item">
            <div class="stat-value">12%</div>
            <div class="stat-label">廃止率</div>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- リーダビリティスコア分布 -->
  <div class="analysis-card" id="readability-card">
    <h2 class="card-title">リーダビリティスコア分布</h2>
    <div class="readability-container">
      <div id="readability-chart"></div>
      <div class="readability-insights">
        <h3>リーダビリティ分析</h3>
        <div class="readability-scale">
          <div class="scale-item easy">
            <span class="scale-label">簡単（30%）</span>
            <div class="scale-bar" style="width: 30%"></div>
          </div>
          <div class="scale-item medium">
            <span class="scale-label">普通（45%）</span>
            <div class="scale-bar" style="width: 45%"></div>
          </div>
          <div class="scale-item hard">
            <span class="scale-label">難しい（25%）</span>
            <div class="scale-bar" style="width: 25%"></div>
          </div>
        </div>
        <p class="readability-summary">
          コンテンツの大部分は適切な難易度ですが、25%のコンテンツが専門的過ぎる可能性があります。これらのページには用語解説や例の追加を検討してください。
        </p>
      </div>
    </div>
  </div>
</div>

<style>
  .advanced-analytics-section {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
    gap: 1.5rem;
    margin-bottom: 2rem;
  }
  
  .analysis-card {
    background: white;
    border-radius: 10px;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
    padding: 1.5rem;
    display: flex;
    flex-direction: column;
    transition: all 0.3s ease;
  }
  
  .analysis-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
  }
  
  .dark .analysis-card {
    background: #222;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
  }
  
  .dark .analysis-card:hover {
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
  }
  
  .card-title {
    font-size: 1.25rem;
    margin-top: 0;
    margin-bottom: 1.25rem;
    padding-bottom: 0.75rem;
    border-bottom: 1px solid #eee;
    color: #333;
  }
  
  .dark .card-title {
    border-bottom-color: #444;
    color: #eee;
  }
  
  /* コンテンツ複雑度分析 */
  .complexity-chart-container {
    height: 250px;
    display: flex;
    flex-direction: column;
  }
  
  #complexity-chart {
    height: 200px;
    margin-bottom: 1rem;
  }
  
  .complexity-legend {
    display: flex;
    flex-wrap: wrap;
    gap: 1rem;
  }
  
  .legend-item {
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }
  
  .legend-color {
    width: 12px;
    height: 12px;
    border-radius: 2px;
  }
  
  /* アクティビティピーク分析 */
  .peaks-chart-container {
    display: flex;
    flex-direction: column;
  }
  
  #peaks-chart {
    height: 180px;
    margin-bottom: 1rem;
  }
  
  .peaks-insights h3 {
    font-size: 1rem;
    margin-top: 0;
    margin-bottom: 0.75rem;
    color: #555;
  }
  
  .dark .peaks-insights h3 {
    color: #ddd;
  }
  
  .peaks-list {
    list-style: none;
    padding: 0;
    margin: 0;
  }
  
  .peaks-list li {
    padding: 0.5rem;
    border-left: 3px solid #4f6df5;
    background-color: #f8fafc;
    margin-bottom: 0.5rem;
    border-radius: 0 0.25rem 0.25rem 0;
  }
  
  .dark .peaks-list li {
    background-color: #1e293b;
    border-left-color: #7b96ff;
  }
  
  .peak-date {
    font-weight: 500;
    margin-bottom: 0.25rem;
  }
  
  .peak-description {
    font-size: 0.9rem;
    color: #666;
  }
  
  .dark .peak-description {
    color: #aaa;
  }
  
  /* コンテンツ進化分析 */
  .evolution-chart-container {
    display: flex;
    flex-direction: column;
  }
  
  #evolution-chart {
    height: 180px;
    margin-bottom: 1rem;
  }
  
  .evolution-stats {
    display: flex;
    justify-content: space-between;
  }
  
  /* ナレッジクラスター分析 */
  .clusters-container {
    display: flex;
    flex-direction: column;
  }
  
  #clusters-chart {
    height: 180px;
    margin-bottom: 1rem;
  }
  
  .clusters-info h3 {
    font-size: 1rem;
    margin-top: 0;
    margin-bottom: 0.75rem;
    color: #555;
  }
  
  .dark .clusters-info h3 {
    color: #ddd;
  }
  
  .cluster-items {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
  }
  
  .cluster-item {
    padding: 0.75rem;
    border-radius: 0.5rem;
    background-color: #f8fafc;
  }
  
  .dark .cluster-item {
    background-color: #1e293b;
  }
  
  .cluster-name {
    font-weight: 500;
    margin-bottom: 0.5rem;
  }
  
  .cluster-tags {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
  }
  
  .cluster-tag {
    font-size: 0.8rem;
    padding: 0.2rem 0.5rem;
    background-color: #e0e7ff;
    color: #4338ca;
    border-radius: 1rem;
  }
  
  .dark .cluster-tag {
    background-color: #312e81;
    color: #c7d2fe;
  }
  
  /* 参照ネットワーク分析 */
  .network-metrics {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 0.5rem;
    margin-bottom: 1rem;
  }
  
  .metric-item {
    text-align: center;
    padding: 0.5rem;
    background-color: #f0f9ff;
    border-radius: 0.5rem;
  }
  
  .dark .metric-item {
    background-color: #082f49;
  }
  
  .metric-value {
    font-size: 1.5rem;
    font-weight: 700;
    color: #0369a1;
  }
  
  .dark .metric-value {
    color: #38bdf8;
  }
  
  .metric-label {
    font-size: 0.8rem;
    color: #555;
  }
  
  .dark .metric-label {
    color: #ccc;
  }
  
  #reference-network-chart {
    height: 200px;
    margin-bottom: 1rem;
  }
  
  .network-insights h3 {
    font-size: 1rem;
    margin-top: 0;
    margin-bottom: 0.5rem;
    color: #555;
  }
  
  .dark .network-insights h3 {
    color: #ddd;
  }
  
  .network-insights p {
    font-size: 0.9rem;
    color: #666;
    margin: 0;
  }
  
  .dark .network-insights p {
    color: #aaa;
  }
  
  /* ページ寿命・更新サイクル分析 */
  .lifecycle-container {
    display: flex;
    flex-direction: column;
  }
  
  #lifecycle-chart {
    height: 180px;
    margin-bottom: 1rem;
  }
  
  .lifecycle-stats .stat-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 1rem;
  }
  
  /* リーダビリティスコア分布 */
  .readability-container {
    display: flex;
    flex-direction: column;
  }
  
  #readability-chart {
    height: 180px;
    margin-bottom: 1rem;
  }
  
  .readability-insights h3 {
    font-size: 1rem;
    margin-top: 0;
    margin-bottom: 0.75rem;
    color: #555;
  }
  
  .dark .readability-insights h3 {
    color: #ddd;
  }
  
  .readability-scale {
    margin-bottom: 1rem;
  }
  
  .scale-item {
    display: flex;
    align-items: center;
    margin-bottom: 0.5rem;
  }
  
  .scale-label {
    width: 140px;
    font-size: 0.9rem;
  }
  
  .scale-bar {
    height: 8px;
    border-radius: 4px;
  }
  
  .easy .scale-bar {
    background-color: #86efac;
  }
  
  .medium .scale-bar {
    background-color: #fbbf24;
  }
  
  .hard .scale-bar {
    background-color: #f87171;
  }
  
  .readability-summary {
    font-size: 0.9rem;
    color: #666;
    margin: 0;
  }
  
  .dark .readability-summary {
    color: #aaa;
  }
  
  /* 統計項目の共通スタイル */
  .stat-item {
    text-align: center;
    padding: 0.75rem 0.5rem;
    background-color: #f8fafc;
    border-radius: 0.5rem;
  }
  
  .dark .stat-item {
    background-color: #1e293b;
  }
  
  .stat-value {
    font-size: 1.5rem;
    font-weight: 700;
    color: #4f6df5;
    margin-bottom: 0.25rem;
  }
  
  .dark .stat-value {
    color: #7b96ff;
  }
  
  .stat-label {
    font-size: 0.8rem;
    color: #555;
  }
  
  .dark .stat-label {
    color: #ccc;
  }
  
  /* レスポンシブ調整 */
  @media (max-width: 768px) {
    .network-metrics {
      grid-template-columns: repeat(2, 1fr);
    }
    
    .lifecycle-stats .stat-grid {
      grid-template-columns: 1fr;
    }
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    // 各グラフの描画関数
    function renderAdvancedCharts() {
      // プレースホルダーチャート（実際の実装時にはD3.jsなどを使用）
      const chartContainers = [
        'complexity-chart',
        'peaks-chart',
        'evolution-chart',
        'clusters-chart',
        'reference-network-chart',
        'lifecycle-chart',
        'readability-chart'
      ];
      
      chartContainers.forEach(containerId => {
        const container = document.getElementById(containerId);
        if (container) {
          container.innerHTML = `<div style="height: 100%; display: flex; align-items: center; justify-content: center; background-color: #f8f9fa; border-radius: 8px; color: #666;">グラフデータ読み込み中...</div>`;
        }
      });
    }
    
    // グラフ描画
    renderAdvancedCharts();
    
    // ウィンドウリサイズ時に再描画
    window.addEventListener('resize', () => {
      renderAdvancedCharts();
    });
  });
</script>
